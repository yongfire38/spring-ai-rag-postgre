spring.application.name=spring-ai-rag-postgre

# PostgreSQL 연결 정보
spring.datasource.url=jdbc:postgresql://localhost:5432/ragdb
spring.datasource.username=raguser
spring.datasource.password=ragpass
spring.datasource.driver-class-name=org.postgresql.Driver

spring.jpa.hibernate.ddl-auto=update

# PgVector 설정
spring.ai.vectorstore.pgvector.initialize-schema=true
spring.ai.vectorstore.pgvector.remove-existing-vector-store-table=false
spring.ai.vectorstore.pgvector.index-type=HNSW
spring.ai.vectorstore.pgvector.distance-type=COSINE_DISTANCE
spring.ai.vectorstore.pgvector.dimensions=768

# Ollama 설정
spring.ai.ollama.base-url=http://localhost:11434
spring.ai.ollama.chat.model=HyperCLOVA-3b:Q4_K_MM
spring.ai.ollama.chat.options.temperature=0.4

# 로컬 ONNX 모델 사용 설정
spring.ai.model.embedding=transformers

# 문서 경로 설정
spring.ai.document.path=file:C:/workspace-test/upload/data/**/*.md

# 로깅 설정
logging.level.com.example.chat=DEBUG
logging.level.org.springframework.ai=DEBUG
logging.level.org.springframework.ai.rag=DEBUG
logging.level.org.springframework.ai.chat.memory=DEBUG

# 빈 오버라이딩 허용 (임베딩 모델 빈 충돌 해결)
spring.main.allow-bean-definition-overriding=true

spring.ai.embedding.transformer.onnx.modelUri=classpath:model/model.onnx
spring.ai.embedding.transformer.tokenizer.uri=classpath:model/tokenizer.json

#모델 출력 이름 설정 (ko-sroberta-multitask 모델에 맞게)
spring.ai.embedding.transformer.onnx.modelOutputName=token_embeddings

# 토크나이저 옵션 최적화
spring.ai.embedding.transformer.tokenizer.options.padding=true
spring.ai.embedding.transformer.tokenizer.options.truncation=true
spring.ai.embedding.transformer.tokenizer.options.maxLength=512
spring.ai.embedding.transformer.tokenizer.options.returnTensor=true

# 비동기 요청 타임아웃 설정 (밀리초)
spring.mvc.async.request-timeout=30000

# Chat Memory JDBC 저장소 스키마 자동 생성
spring.ai.chat.memory.repository.jdbc.initialize-schema=always

# Flyway 설정 (비활성화)
spring.flyway.enabled=false

# RAG 설정 (Redis 버전과 동일)
rag.prompt.pattern=
rag.similarity.threshold=0.30
rag.top-k=5